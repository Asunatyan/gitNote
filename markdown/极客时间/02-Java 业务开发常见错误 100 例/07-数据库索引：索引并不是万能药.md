# InnoDB 是如何存储数据的？



各个数据页组成一个双向链表，每个数据页中的记录按照主键顺序组成单向链表；每一个数据页中有一个页目录，方便按照主键查询记录。数据页的结构如下：

![img](../../../pic/markdown/1302b4a8d877609486c9a9eed2d8d8d1.png)

页目录通过槽把记录分成不同的小组，每个小组有若干条记录。

如图所示，**记录中最前面的小方块中的数字**(比如槽位0,小方块显示的是1,那么就是一条记录,再比如:槽位5,最前面的是记录20,小方块是4代表是这个槽位有4个记录,重下往上)，代表的是当前分组的记录条数，最小和最大的槽指向 2 个特殊的伪记录。

有了槽之后，我们按照主键搜索页中记录时，就可以采用二分法快速搜索，无需从最小记录开始遍历整个页中的记录链表。

# 聚簇索引和二级索引

![img](../../../pic/markdown/e76adf029e63a045e05956039f81f265.png)

我们再看看 B+ 树如何实现快速查找主键。比如，我们要搜索 PK=4 的数据，通过根节点中的索引可以知道数据在第一个记录指向的 2 号页中，通过 2 号页的索引又可以知道数据在 5 号页，5 号页就是实际的数据页，然后再通过二分法查找页目录马上可以找到记录的指针。



怎么理解上面这句话

- 先看下图

- 一个数据页有多行记录,对应上图的叶子结点,
  - 比如上图的叶子结点#4,那么行记录的数据就对应到了结点里面的数据1,2等

![img](../../../pic/markdown/919737-20180408164025591-158405878.jpg)























